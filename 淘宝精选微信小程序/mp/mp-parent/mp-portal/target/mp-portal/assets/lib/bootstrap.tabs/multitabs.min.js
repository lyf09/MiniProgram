if("undefined"==typeof jQuery)throw new Error("MultiTabs requires jQuery");!function(a){"use strict";var c,b=".multitabs",e=function(a,c,d,e,f){var g=f?c:c.split(" ").join(b+" ")+b;a.off(g,d,e).on(g,d,e)},f=function(a,b){return"main"===a?0:(b=b||8,c=c||0,c++,c%=b)},i=function(b,c){var d,e,f,g;for(c=c||a.fn.multitabs.defaults.navTab.maxTitleLength,d=(b+"").split(" "),e="",f=0;f<d.length;f++)g=a.trim(d[f]),e+=g?g+" ":"";return e.length>c&&(e=e.substr(0,c),e+="..."),e},j=function(){return!(void 0===sessionStorage)},h=function(b){var c=0;return a(b).each(function(){c+=a(this).outerWidth(!0)}),c},g=function(a){var b=function(a){var b=document.createElement("a");return b.href=a,b.href}(a),c=window.location.protocol+"//"+window.location.host+"/",d=b.substr(0,c.length);return!(d===c)},k={"default":'<div class="mt-wrapper {mainClass}" style="height: 100%;" ><div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};"><div class="mt-nav mt-nav-tools-left"><ul  class="nav {nav-tabs}"><li class="mt-move-left"><a><i class="fa fa-backward"></i></a></li></ul></div><nav class="mt-nav mt-nav-panel"><ul  class="nav {nav-tabs}"></ul></nav><div class="mt-nav mt-nav-tools-right"><ul  class="nav {nav-tabs}"><li class="mt-move-right"><a><i class="fa fa-forward"></i></a></li><li class="mt-dropdown dropdown"><a href="#"  class="dropdown-toggle" data-toggle="dropdown">{dropdown}<span class="caret"></span></a><ul role="menu" class="dropdown-menu dropdown-menu-right"><li class="mt-show-actived-tab"><a>{showActivedTab}</a></li><li class="divider"></li><li class="mt-close-all-tabs"><a>{closeAllTabs}</a></li><li class="mt-close-other-tabs"><a>{closeOtherTabs}</a></li></ul></li></ul></div></div><div class="tab-content mt-tab-content " > </div></div>',classic:'<div class="mt-wrapper {mainClass}" style="height: 100%;" ><div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};"><nav class="mt-nav mt-nav-panel"><ul  class="nav {nav-tabs}"> </ul></nav><div class="mt-nav mt-nav-tools-right"><ul  class="nav {nav-tabs}"><li class="mt-dropdown dropdown"><a href="#"  class="dropdown-toggle" data-toggle="dropdown">{dropdown}<span class="caret"></span></a><ul role="menu" class="mt-hidden-list dropdown-menu dropdown-menu-right"></ul></li></ul></div></div><div class="tab-content mt-tab-content " > </div></div>',simple:'<div class="mt-wrapper {mainClass}" style="height: 100%;" ><div class="mt-nav-bar {navBarClass}" style="background-color: {backgroundColor};"><nav class="mt-nav mt-nav-panel"><ul  class="nav {nav-tabs}"> </ul></nav></div><div class="tab-content mt-tab-content " > </div></div>',navTab:'<a data-id="{navTabId}" class="mt-nav-tab" data-type="{type}" data-index="{index}" data-url="{url}">{title}</a>',closeBtn:' <i class="mt-close-tab fa fa-times" style="{style}"></i>',ajaxTabPane:'<div id="{tabPaneId}" class="tab-pane {class}">{content}</div>',iframeTabPane:'<iframe id="{tabPaneId}" class="tab-pane {class}"  width="100%" height="100%" frameborder="0" src="" seamless></iframe>'},l=[{type:"main",title:"main",content:"<h1>Demo page</h1><h2>Welcome to use bootstrap multi-tabs :) </h2>"}],d=function(b,c){var d=this;d.$element=a(b),d._init(c)._listen()._final()};d.prototype={constructor:d,create:function(a,b){this.options;var d,e;return(d=this._getParam(a))?(e=this._exist(d))?(this.active(e),this):(d.active=void 0===d.active?b:d.active,e=this._createNavTab(d),this._createTabPane(d),this._storage(d.id,d),d.active&&this.active(e),this):this},_createTabPane:function(a){var b=this,c=b.$element;return c.tabContent.append(b._getTabPaneHtml(a)),c.tabContent.find("#"+a.id)},_getTabPaneHtml:function(a){var b=this,c=b.options;return!a.content&&a.iframe?k.iframeTabPane.replace("{class}",c.iframeTabPane.class).replace("{tabPaneId}",a.id):k.ajaxTabPane.replace("{class}",c.ajaxTabPane.class).replace("{tabPaneId}",a.id).replace("{content}",a.content)},_createNavTab:function(a){var b=this,c=b.$element,d=b._getNavTabHtml(a),e=c.navPanelList.find('a[data-type="'+a.type+'"][data-index="'+a.index+'"]').parent("li");return e.length?(e.html(d),b._getTabPane(e.find("a:first")).remove()):c.navPanelList.append("<li>"+d+"</li>"),c.navPanelList.find('a[data-type="'+a.type+'"][data-index="'+a.index+'"]:first')},_getNavTabHtml:function(a){var b=this,c=b.options,e=c.showClose?"display:inline;":"",d="main"===a.type?"":k.closeBtn.replace("{style}",e);return k.navTab.replace("{index}",a.index).replace("{navTabId}",a.id).replace("{url}",a.url).replace("{title}",a.title).replace("{type}",a.type)+d},_generateId:function(a){return"multitabs_"+a.type+"_"+a.index},active:function(a){var e,f,g,h,i,j,b=this,c=b.$element;return b.options,e=b._getNavTab(a),f=b._getTabPane(e),g=c.navPanelList.find("li.active:first a"),h=g.length?b._getParam(g):{},i=e.length?b._getParam(e):{},j=b._storage(),j[h.id]&&(j[h.id].active=!1),j[i.id]&&(j[i.id].active=!0),b._resetStorage(j),g.parent("li").removeClass("active"),e.parent("li").addClass("active"),b._fixTabPosition(e),b._getTabPane(g).removeClass("active"),f.addClass("active"),b._fixTabContentLayout(f),b._fillTabPane(f,i),b},_fillTabPane:function(b,c){var d=this,e=d.options,f=a(b);f.html()||(f.is("iframe")?f.attr("src")||f.attr("src",c.url):a.ajax({url:c.url,dataType:"html",success:function(a){f.html(e.ajaxSuccess(a))},error:function(a){f.html(e.ajaxError(a))}}))},moveLeft:function(){var i,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=h(b.navPanelList.children("li")),f=0,g=0;if(d>e)return a;for(i=b.navPanelList.children("li:first");g+i.width()<=c;)g+=i.outerWidth(!0),i=i.next();if(g=0,h(i.prevAll())>d){for(;g+i.width()<d&&i.length>0;)g+=i.outerWidth(!0),i=i.prev();f=h(i.prevAll())}return b.navPanelList.animate({marginLeft:0-f+"px"},"fast"),a},moveRight:function(){var g,i,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=h(b.navPanelList.children("li")),f=0;if(d>e)return a;for(g=b.navPanelList.children("li:first"),i=0;i+g.width()<=c;)i+=g.outerWidth(!0),g=g.next();for(i=0;i+g.width()<d&&g.length>0;)i+=g.outerWidth(!0),g=g.next();return f=h(g.prevAll()),f>0&&b.navPanelList.animate({marginLeft:0-f+"px"},"fast"),a},close:function(a){var f,g,b=this,d=b._getNavTab(a),e=d.parent("li"),c=b._getTabPane(d);return e.length&&c.length&&c.hasClass("unsave")&&!b._unsaveConfirm()?b:(e.hasClass("active")&&(f=e.next("li:first"),g=e.prev("li:last"),f.size()?b.active(f):g.size()&&b.active(g)),b._delStorage(d.attr("data-id")),e.remove(),c.remove(),b)},closeOthers:function(){var b=this,c=b.$element;return c.navPanelList.find("li:not(.active)").find('a:not([data-type="main"])').each(function(){var c=a(this);b._delStorage(c.attr("data-id")),b._getTabPane(c).remove(),c.parent("li").remove()}),c.navPanelList.css("margin-left","0"),b},showActive:function(){var a=this,b=a.$element,c=b.navPanelList.find("li.active:first a");return a._fixTabPosition(c),a},closeAll:function(){var b=this,c=b.$element;return c.navPanelList.find('a:not([data-type="main"])').each(function(){var c=a(this);b._delStorage(c.attr("data-id")),b._getTabPane(c).remove(),c.parent("li").remove()}),b.active(c.navPanelList.find('a[data-type="main"]:first').parent("li")),b},_init:function(a){var d,b=this,c=b.$element;return c.html(k[a.layout].replace("{mainClass}",a.class).replace("{navBarClass}",a.navBar.class).replace(/\{nav-tabs\}/g,a.style).replace(/\{backgroundColor\}/g,a.navBar.backgroundColor).replace("{dropdown}",a.language.navBar.dropdown).replace("{showActivedTab}",a.language.navBar.showActivedTab).replace("{closeAllTabs}",a.language.navBar.closeAllTabs).replace("{closeOtherTabs}",a.language.navBar.closeOtherTabs)),c.wrapper=c.find(".mt-wrapper:first"),c.navBar=c.find(".mt-nav-bar:first"),c.navToolsLeft=c.navBar.find(".mt-nav-tools-left:first"),c.navPanel=c.navBar.find(".mt-nav-panel:first"),c.navPanelList=c.navBar.find(".mt-nav-panel:first ul"),c.navToolsRight=c.navBar.find(".mt-nav-tools-right:first"),c.tabContent=c.find(".tab-content:first"),a.navBar.maxTabs<=1&&(a.navBar.maxTabs=1,c.navBar.hide()),d=c.navBar.find(".mt-nav-tools-left:visible:first").width()+c.navBar.find(".mt-nav-tools-right:visible:first").width(),c.navPanel.css("width","calc(100% - "+d+"px)"),b.options=a,b},_final:function(){var e,g,h,b=this,c=b.$element,d=b.options,f=d.init;if(j&&(e=b._storage(),b._resetStorage({}),a.each(e,function(a,c){b.create(c,!1)})),a.isEmptyObject(e))for(f=!a.isEmptyObject(f)&&f instanceof Array?f:l,h=0;h<f.length;h++)g=b._getParam(f[h]),g&&b.create(g);return c.navPanelList.children("li.active").length||b.active(c.navPanelList.find('[data-type="main"]:first')),b},_listen:function(){var f,b=this,c=b.$element,d=b.options;return e(a(document),"click",d.link,function(){return b.create(this,!0),!1}),e(c.navBar,"click",".mt-nav-tab",function(){b.active(this)}),d.draggable&&e(c.navPanelList,"mousedown",".mt-nav-tab",function(b){var d=a(this),e=d.closest("li"),f=e.prev(),g=!0,h=!1,i="main"===d.data("type"),j='<li id="multitabs_tmp_tab_blank" class="mt-drag-tmp" style="width:'+e.outerWidth()+"px; height:"+e.outerHeight()+'px;"><a style="width: 100%;  height: 100%; "></a></li>',k=b.pageX-e.offset().left+c.navBar.offset().left;e.before(j),e.css({left:b.pageX-k+"px",position:"absolute","z-index":9999}).addClass("mt-drag-tmp").find("a:first").css({background:"#f39c12"}),a(document).on("mousemove",function(b){g&&!i&&(e.css({left:b.pageX-k+"px"}),c.navPanelList.children('li:not(".mt-drag-tmp")').each(function(){var b=a(this).offset().left+a(this).outerWidth()+20;return b>e.offset().left?("multitabs_tmp_tab_blank"!==a(this).next().attr("id")&&(h=!0,f=a(this),a("#multitabs_tmp_tab_blank").remove(),f.after(j)),!1):void 0}))}).on("selectstart",function(){return g?!1:void 0}).on("mouseup",function(){g&&(e.css({left:"0px",position:"relative","z-index":"inherit"}).removeClass("mt-drag-tmp").find("a:first").css({background:""}),a("#multitabs_tmp_tab_blank").remove(),h&&f.after(e)),g=!1})}),e(c.navBar,"click",".mt-close-tab",function(){return b.close(a(this).closest("li")),!1}),e(c.navBar,"click",".mt-move-left",function(){return b.moveLeft(),!1}),e(c.navBar,"click",".mt-move-right",function(){return b.moveRight(),!1}),e(c.navBar,"click",".mt-show-actived-tab",function(){return b.showActive(),!1}),e(c.navBar,"click",".mt-close-all-tabs",function(){return b.closeAll(),!1}),e(c.navBar,"click",".mt-close-other-tabs",function(){return b.closeOthers(),!1}),f=c.navBar.outerHeight(),c.tabContent.css("paddingTop",f),d.fixed&&e(a(window),"scroll",function(){var b=a(this).scrollTop();return b=b<c.wrapper.height()-f?b+"px":"auto",c.navBar.css("top",b),!1}),"classic"===d.layout&&e(c.navBar,"click",".mt-dropdown:not(.open)",function(){var a=b._getHiddenList(),d=c.navToolsRight.find(".mt-hidden-list:first").empty();if(a){for(;a.prevList.length;)d.append(a.prevList.shift().clone());for(;a.nextList.length;)d.append(a.nextList.shift().clone())}else d.append("<li>empty</li>")}),b},_getParam:function(b){if(a.isEmptyObject(b))return!1;var c=this,d=c.options,e={},h=a(b);return e.content=h.data("content")||b.content||d.content||"",e.content.length?e.url="":(e.url=h.data("url")||b.url||h.attr("href")||h.attr("url")||"",e.url=a.trim(decodeURIComponent(e.url.replace("#","")))),e.url.length||e.content.length?(e.iframe=h.data("iframe")||b.iframe||g(e.url)||d.iframe,e.type=h.data("type")||b.type||d.type,e.title=h.data("title")||b.title||h.text()||e.url.replace("http://","").replace("https://","")||d.language.navBar.title,e.title=i(e.title,d.navBar.maxTitleLength),e.active=h.data("active")||b.active,e.index=h.data("index")||b.index||f(e.type,d.navBar.maxTabs),e.id=h.data("id")||b.id||this._generateId(e),e):!1},_storage:function(a,b){if(j()){var c=JSON.parse(sessionStorage.multitabs||"{}");return a?b?(c[a]=b,sessionStorage.multitabs=JSON.stringify(c),c):c[a]:c}},_delStorage:function(a){if(j()){var b=JSON.parse(sessionStorage.multitabs||"{}");return a?(delete b[a],sessionStorage.multitabs=JSON.stringify(b),b):b}},_resetStorage:function(a){j()&&"object"==typeof a&&(sessionStorage.multitabs=JSON.stringify(a))},_exist:function(a){var b,c,d;return a&&a.url?(b=this,c=b.$element,d=c.navPanelList.find('a[data-url="'+a.url+'"]:first'),d.length?d:!1):!1},_getTabPane:function(b){return a("#"+a(b).attr("data-id"))},_getNavTab:function(b){var c=this,d=c.$element,e=a(b).attr("data-id")||a(b).find("a").attr("data-id");return d.navPanelList.find('a[data-id="'+e+'"]:first')},_fixTabPosition:function(b){var c=this,d=c.$element,e=a(b).parent("li"),f=e.outerWidth(!0),g=e.prev().outerWidth(!0),i=e.prev().prev().outerWidth(!0),j=h(e.prevAll()),k=h(e.nextAll()),l=d.navPanel.outerWidth(!0),m=h(d.navPanelList.children("li")),n=0;if(l>m)n=0;else if(l>=g+f+k)for(n=j;l>m-n+g;)e=e.prev(),n-=e.outerWidth();else j+f>l&&(n=j-g-i);n=n>0?n:0,d.navPanelList.animate({marginLeft:0-n+"px"},"fast")},_getHiddenList:function(){var i,j,a=this,b=a.$element,c=Math.abs(parseInt(b.navPanelList.css("margin-left"))),d=b.navPanel.outerWidth(!0),e=h(b.navPanelList.children("li")),f=[],g=[];if(d>e)return!1;for(i=b.navPanelList.children("li:first"),j=0;j+i.width()<=c;)j+=i.outerWidth(!0),f.push(i),i=i.next();if(e>j)for(i=b.navPanelList.children("li:last"),j=e;j>c+d;)j-=i.outerWidth(!0),g.unshift(i),i=i.prev();return{prevList:f,nextList:g}},_fixTabContentLayout:function(b){var c=a(b);c.is("iframe")?(a("body").addClass("full-height-layout"),c.css("height","99%"),window.setTimeout(function(){c.css("height","100%")},0)):a("body").removeClass("full-height-layout")}},a.fn.multitabs=function(b,c){var i,e=a(this),f=c?c:"multitabs",g=a(document).data(f),h="object"==typeof b&&b;return g||(i=a.extend(!0,{},a.fn.multitabs.defaults,h,e.data()),i.style="nav-pills"===i.style?"nav-pills":"nav-tabs",g=new d(this,i),a(document).data(f,g)),a(document).data(f)},a.fn.multitabs.defaults={showClose:!1,draggable:!0,fixed:!1,layout:"default",style:"nav-tabs",link:".multitabs",iframe:!1,"class":"",type:"info",init:[],navBar:{"class":"",maxTabs:15,maxTitleLength:25,backgroundColor:"#f5f5f5"},ajaxTabPane:{"class":""},iframeTabPane:{"class":""},language:{navBar:{title:"Tab",dropdown:'<i class="fa fa-bars"></i>',showActivedTab:"Show Activated Tab",closeAllTabs:"Close All Tabs",closeOtherTabs:"Close Other Tabs"}},ajaxSuccess:function(a){return a},ajaxError:function(a){return a}}}(jQuery);